Commit Hash,Date,Author,Tags,Full Commit Message,Version,Short Commit Message
dc38f5ef30fee8f28d99935b1772dcd98eefda61,2/11/2025 17:17,Liam Sullivan,"tag: V3.1_and_odic_splitpoint, odic/V3.1, ghlgit/GHL_V3.1, GHL_V3.1",Merge remote-tracking branch 'origin/GHL_PM_V3.1_ghlRC4' into V3.1,V3.1,LAST ODIC TOUCHPOINT
93d14f8a9eecd61b4370049766772f11ffacb659,2/12/2025 11:27,Simon Ghionea,,"set for JLINK debug, sample-prep, and MOTOR_FG_REWORK (unit56 board)",V3.2rc1,<devops>
28a97125c71b660b64b7d03dec809d015de5126e,11/15/2024 12:22,Simon Ghionea,,GHL add basic CDC serial command handling for SETCLK to allow setting the datetime through serial,V3.2rc1,add USB cdc commands
bdee8f51afb11a4ea5335e9a662cfac22553f52d,2/12/2025 16:05,Simon Ghionea,,"double the size of the logger queue, to allow more debug and event log messages to be processed",V3.2rc1,"improve robustness, reduce bugs, add debug outputs"
2ae17d2465bc1347d216b2845dccf750bc5c2cfa,2/12/2025 16:07,Simon Ghionea,,"changes to low battery logging, re-write message to file when above recovery"" voltage""",V3.2rc1,add additional logging for low-battery transitions
1e371f5160c163c85448156fb2e186eb35862b9c,2/12/2025 16:16,Simon Ghionea,,changes power-on message and make applicable to all bootups or resets,V3.2rc1,add additional logging on bootup
74c0f5425228e96ee13722c50cfd0058e613fb24,2/14/2025 12:54,Simon Ghionea,,CDC serial command GETVER,V3.2rc1,add USB cdc commands
e60af5cb79d97dce4604e9389ac4092243abed85,2/14/2025 16:17,Simon Ghionea,,"WIP: remap usb endpoints, to have simultaneous MSC and CDC. kind-of works, but when doing a sample-prep run there are pretty frequent NOR flash errors and reboots in the middle of runs :-(",V3.2rc1,rework USB to allow simultaneous CDC and MSC modes
bb5568f43d571ff2dfca32ccb420c75de518e9f3,2/18/2025 20:26,Simon Ghionea,,move cdc serial port rx parsing out of logger task and into main_task,V3.2rc1,<devops>
d765d4ac7fea6cc89e3366082ca607f45c43f4ed,2/18/2025 20:58,Simon Ghionea,,add USB CDC COM commands STATUS and CFGGET,V3.2rc1,add USB cdc commands
af01f6d752cb12da57af5151516383549233190a,2/18/2025 21:38,Simon Ghionea,"ghlgit/GHL_usb_work_msc_and_cdc_simultaneous, GHL_usb_work_msc_and_cdc_simultaneous",add reboot log-message that includes reset-reasons from NRF registers,V3.2rc1,add additional logging on bootup
0632d77aa9590249a5e7a27ce754ef3a45b9ff38,2/20/2025 16:52,Simon Ghionea,,set compile for powermodule,V3.2rc1,<devops>
cb987298aee358245e91f78ee978a5fdf2a6819a,2/20/2025 16:52,Simon Ghionea,,make GETCFG compile for power module,V3.2rc1,<devops>
9085db652d770c39e904a2a86608abb309127aff,2/21/2025 10:33,Simon Ghionea,,"work on USB-CDC commands, move to a separate new task",V3.2rc1,add USB cdc commands
cdce1de7fe647a8fe7524190075d78a1e5d93dac,2/21/2025 11:18,Simon Ghionea,,trigger power module only on low->high transition (don't begin run when powered on with cassette installed),V3.2rc1,change powermodule run-start conditions to require state change
ce62a1f614a2e129d9773f297360477205ed22bd,2/21/2025 11:58,Simon Ghionea,,add software watchdog debug statements to try to debug watchdog resets,V3.2rc1,"improve robustness, reduce bugs, add debug outputs"
e8dd5386399758cac2f2a90078ed061b8c2b6abb,2/21/2025 12:15,Simon Ghionea,,fix the consistent software watchdog reset in heater_task on powermodule run completion on the first successful run after bootup,V3.2rc1,fix problem where powermodule was rebooting after successful run completion
8c494d43837662a66ac2d19b6e597c33391b8873,2/21/2025 12:16,Simon Ghionea,,start simple GPREGRET2 usage and logging on first boot-up,V3.2rc1,add additional logging on bootup
3ca23b56032b70cb778970a201e3b3a94d29e589,2/21/2025 12:56,Simon Ghionea,,make USB CDC command REFORMAT work,V3.2rc1,add USB cdc commands
5ab1cd874d28a188d7f29f11fc7efa1370ef40d6,2/21/2025 13:11,Simon Ghionea,,USB CDC status command add uniqueid (device mac address),V3.2rc1,add USB cdc commands
f3588d340fa4fd08e70562d4bc50850f58639cf8,2/21/2025 13:34,Simon Ghionea,,set to bootloader linker,V3.2rc1,<devops>
b5bd57e54fde8dfbee35e519a42e16df20109165,2/21/2025 13:35,Simon Ghionea,"tag: PM_V3.2rc1, ghlgit/GHL_PM_debug_reboot_after_goodrun, ghlgit/GHL_PM_V3.2rc1, GHL_PM_debug_reboot_after_goodrun, GHL_PM_V3.2rc1",bump version string to 3.2rc1 and set defaults according to chin's testing,V3.2rc1,set default config
082b9425fd65b9b9affdd8aaa58ef2c7eac286e9,2/21/2025 16:13,Simon Ghionea,,"Power Module buzzer capability hacked-in, with simple tones on error and on completion",v3.2rc2,add powermodule buzzer support
175495f974a0527896eb35edb4f922060aeddb14,2/21/2025 21:02,Simon Ghionea,"ghlgit/GHL_PM_bringup_buzzer_and_other_leds, GHL_PM_bringup_buzzer_and_other_leds",better CFGGET formatting,v3.2rc2,add USB cdc commands
f3c5d54e109bfe3529a6a24a4e87b9f50b04d3b6,2/11/2025 14:12,Simon Ghionea,,WIP: add some query to the RTC,v3.2rc2,fix RTC reset issue seen when batteries first plug in
d405fc23fbf9ac2903b18e081272c790e529b74f,2/21/2025 22:57,Simon Ghionea,"ghlgit/GHL_better_clockcalendar_inits, GHL_better_clockcalendar_inits","fix RTC not ticking problem on some units by always reset RTC when setting time, and add a USB CDC function to read and return some RTC status register",v3.2rc2,fix RTC reset issue seen when batteries first plug in
004a3cf817e5aad86d21cf2e6473ac3aa882617e,2/22/2025 10:17,Simon Ghionea,,WIP kv store implementation,v3.2rc2,rework configuration file framework to use key-value tables
b49bb587bbb7001d08a17a73b2f7afb86e9b45b4,2/22/2025 17:44,Simon Ghionea,,Power module add short sound on startup,v3.2rc2,add powermodule buzzer support
61c2378c25b19b6b4569aa36a1ea8b0492d9439a,2/22/2025 17:49,Simon Ghionea,,Merge branch 'GHL_V3.2rc2' into GHL_rework_storage_to_keyvalue_pairs,v3.2rc2,rework configuration file framework to use key-value tables
77bfbe4824b5a00ace952c0d6637918bf863c3e0,2/22/2025 22:47,Simon Ghionea,,"WIP: master and cycle configs now being read with key value system, powermodule tested but not SP yet",v3.2rc2,rework configuration file framework to use key-value tables
7276c338b7aad3b080a7dee9aaf660ea1a7a49e9,2/23/2025 13:33,Simon Ghionea,,"change storage to create master config file from the key-value table, add powermodule sound volume to config",v3.2rc2,rework configuration file framework to use key-value tables
5656ca5c2b0bc8ed623152fe770a7427366c3c59,2/23/2025 20:42,Simon Ghionea,,tested key-value store on sampleprep,v3.2rc2,rework configuration file framework to use key-value tables
015b2ecbc64b06c0f8676c909632572f97245bb2,2/24/2025 7:29,Simon Ghionea,,bump version to V3.2rc2 (works SP and PM); do_automatic_runs now config item for sampleprep,v3.2rc2,set default config
05da0701283b36f52ff87c02e7bc10486849f238,2/24/2025 13:59,Simon Ghionea,"tag: V3.2rc2, ghlgit/GHL_rework_storage_to_keyvalue_pairs, ghlgit/GHL_V3.2rc2, GHL_rework_storage_to_keyvalue_pairs, GHL_V3.2rc2",handle issue for motor-stall where mainErrorQueue has > 1 items on stall condition; add I2C retry counter and message in log,v3.2rc2,fix sampleprep issue which manifested with subsequent runs after stall could terminate early with erroneous stall message; add I2C retry counter logging
8795ac0f96244010d51d28677e8934197bcd9904,2/25/2025 6:31,Simon Ghionea,ghlgit/GHL_V3.2,add decorators to naatos_config_File.c,v3.2rc3,<devops>
915ba1fd4e83b5e5d01a2e664d5692bde95233da,2/25/2025 15:39,Simon Ghionea,,fix typo in the power module config for valve zone PID values (Swapped KI and KD),v3.2rc3,fix typo with powermodule configuration table
53eee6a8a880f4180bb6b39cdf7e22e5abe23cad,2/25/2025 15:41,Simon Ghionea,"tag: PM_V3.2rc3, ghlgit/GHL_V3.2rc3, GHL_V3.2rc3",version string to V3.2rc3,v3.2rc3,<devops>
00001088fca87c68061839015d393ed694c09ef3,2/25/2025 16:40,Simon Ghionea,,bump version to 3.2rc4; make do_automatic_runs work for power module as well,v3.2rc4,make powermodule also support do_automatic_runs
d228f7034bf4315a3f3ac29ff2de40e859ed9922,2/26/2025 12:36,Simon Ghionea,,change CFGGET command to dump more information about config; typo in a PM config parameter,v3.2rc4,add USB cdc commands
8b70ef4382cc68b4e188b36c43150e5f5521e8f6,2/26/2025 12:59,Simon Ghionea,,PM make choice of top or front led's configurable through config file,v3.2rc4,fix powermodule usage of front led set
7c9f56609d5aba2a8c4440233c704f1169dfaf33,2/26/2025 13:30,Simon Ghionea,,speed up breathing led driver pattern,v3.2rc4,led notifications: speed up all breathing patterns
d9543dc8f8f452bc9deaeb25554226ac7de0a350,2/27/2025 7:18,Simon Ghionea,,add REBOOT serial command,v3.2rc4,add USB cdc commands
da6bb1f4f74ca5b3ec6eeab4d2f4bf970c9377af,2/27/2025 15:23,Simon Ghionea,,"major: add double-yellow, add graceperiod config parameter, update default config, re-work FSM to allow temperature not reached terminations, add solid-red sample invalidation logic",v3.2rc4,"led notifications: rework framework, add double-yellow graceperiod, solid-red sample invalidation"
39f11de9204190be98055061d9369aceff483547,2/27/2025 19:06,Simon Ghionea,,"fix with temperature setpoint reached messages being sent upon stopping heaters, where not appropriate",v3.2rc4,"led notifications: rework framework, add double-yellow graceperiod, solid-red sample invalidation"
f486a1c1cff4bd3f00d45e7f62515f88590e2fa2,2/28/2025 10:10,Simon Ghionea,,"PM add additional audio alert, mario song, and accompanying config parameters",v3.2rc4,add powermodule buzzer support
cc04c601b1ad3a7df8729a0d1963b6eb9e05ddc7,2/28/2025 10:50,Simon Ghionea,,Add capability to main_task to receive low-rate temperature data in MAIN_STANDBY state; planning to use this to determine if we can start a run,v3.2rc4,led notifications: add solid-yellow run startability capability; and red-magenta flashing for device cannot run
549c84a8f9e6e6c337b4a3eb8935da182d56fae8,2/28/2025 14:07,Simon Ghionea,,strip out min_run_zone_temp handling from powermoduleheater and sampleprepheater tasks; plan to re-implement at higher level,v3.2rc4,led notifications: add solid-yellow run startability capability; and red-magenta flashing for device cannot run
9e1e2dee232a7e0af2d6db6159c1b48f03c5f46d,2/28/2025 14:12,Simon Ghionea,,prepare to start using global flags to track whether or not we can start a run or the device is working well,v3.2rc4,led notifications: add solid-yellow run startability capability; and red-magenta flashing for device cannot run
523dc339b7c598ecc77b06075fb7110b0a868820,2/28/2025 15:46,Simon Ghionea,"ghlgit/GHL_rework_if_run_possible_during_standby, GHL_rework_if_run_possible_during_standby","reworked alert system and run-start system to show yellow led if starting is not possible, yellow-red cycling if device error has occurred",v3.2rc4,led notifications: add solid-yellow run startability capability; and red-magenta flashing for device cannot run
fe979ef983fa6a923f477e80cd446c8b4eee79da,2/28/2025 16:11,Simon Ghionea,,add some additional tracking information to help trace logging errors,v3.2rc4,"improve robustness, reduce bugs, add debug outputs"
75ce61af2c7c7358c059fa20438a45ddb1f628e8,2/28/2025 16:26,Simon Ghionea,,"fix issue with battery level led updating, after all the changes to the led indications",v3.2rc4,"led notifications: rework framework, add double-yellow graceperiod, solid-red sample invalidation"
fde22a98fc520361aed3eef8cfac50f8f953e79a,2/28/2025 16:47,Simon Ghionea,GHL_SG_working_rc4,"add a canary global configuration parameter, to help detect if we could load a config properly",v3.2rc4,"improve robustness, reduce bugs, add debug outputs"
68623fe7fa5b1705f35cea87b5c6e8183b4fcd48,3/1/2025 12:02,Simon Ghionea,,"changed mkfs fat filesystem arguments (2k allocation unit instead of the default), added some additional error checking in nand and storage initialization which would result in yellow-red alternating",v3.2rc4,"improve robustness, reduce bugs, add debug outputs"
9fba97a74e077944aedc3bd4d65bf3385429424d,3/2/2025 8:47,Simon Ghionea,,add more info to STATUS USBCDC message,v3.2rc4,add USB cdc commands
c30424144e0507093171f750c104e606c8346a50,3/3/2025 10:27,Simon Ghionea,,fix for some corner case of sensor reading failures on power-module transition from valve/amp=TRUE to amp=TRUE/VALVE=TRUE (cycle 3-4 transition),v3.2rc4,fix bug transitioning from power-module cycle 3 to power-module cycle 4 related to temperature sensor reading
9b432264ee93f97cf38cc2d1faebd89c79f03c5e,3/3/2025 13:53,Simon Ghionea,,addressing some SERIAL message lines getting lost when sending from device,v3.2rc4,add USB cdc commands
d0f199e08e6f7f5e27a8151baa85a9560efa6eba,3/3/2025 14:49,Simon Ghionea,,change power module defaults before release for test,v3.2rc4,set default config
9410e3f560c76cc9c8f091bb85b703c35c7a4374,3/3/2025 15:30,Simon Ghionea,,"move global config initialization earlier in naatos_storage, and revert to AUTO block size for mkfs()",v3.2rc4,"improve robustness, reduce bugs, add debug outputs"
582ab962e6a3b67b048d68ba6f29524be0689917,3/3/2025 21:05,Simon Ghionea,ghlgit/GHL_V3.2rc4,fix compilation for sampleprep,v3.2rc4,<devops>
87a022ead61d138d793c6aed90337432915dc7c6,3/4/2025 7:43,Simon Ghionea,"tag: PM_V3.2rc4, GHL_V3.2rc4","new CDC command LSDIR, add delay to REFORMAT",v3.2rc4,add USB cdc commands
df8a6097adbd346636263ba73f4cf42befb78764,3/6/2025 9:25,Simon Ghionea,,"Major LED driver and notification rework to support new LED scheme (battery led2 always show batter, everything else on led1); new approach to IS31FL3196 LED driver using local register values and bitfields",v3.3,"led notifications: led driver re-write, always show battery on the BATTERY led"
465660271b29cb4fbff0760c2d4c3907b62b71bd,3/6/2025 10:25,Simon Ghionea,,change defaults for sampleprep for new fw features,v3.3,set default config
914df64db320a19230c9279fd2e9726ce6c0b348,3/6/2025 10:27,Simon Ghionea,,bump version to V3.3,v3.3,set default config
cd5c6f3fca15407a9a1327ca6ab540b593dcc87e,3/6/2025 16:50,Simon Ghionea,"tag: V3.3, ghlgit/GHL_V3.3, GHL_V3.3",changed a default for sampleprep,v3.3,set default config
e742aedeb28a68c83a9312770783aacef7131084,3/7/2025 12:33,Simon Ghionea,,"refactor: move and organize all USB CDC commands into own compilation unit/files, and modularize command handlers with a lookup table",v3.4,<devops>
078f00326347c987ddd59cfc13816ef3bc18236e,3/7/2025 13:43,Simon Ghionea,,USB CDC command CFGGET new formatting,v3.4,add USB cdc commands
9c476fb49c1c1528cdddc4ee784fcbb21be80f79,3/7/2025 13:54,Simon Ghionea,,handle com_write() situation where NRF_ERROR_BUSY was returned from Nordic USB driver; will now delay shortly and yield to other threads during that delay; handles nicely missing output when lots of data sent to the com port,v3.4,add USB cdc commands
84e3b41060df036e59beb4b174e96ba295abeaa9,3/7/2025 15:37,Simon Ghionea,,added USB CDC command CFGSET with global and writeglobal subcommands,v3.4,add USB cdc commands
07c0bea1013b490fec60f3676358a5c1e05cb4c3,3/7/2025 20:43,Simon Ghionea,,"USB CDC LSDIR"" command",v3.4,add USB cdc commands
f8f319a432e9fe94db88dcaf504e71f68b00bb22,3/9/2025 13:51,Simon Ghionea,,"bump to V3.4; add to segger project build-configurations for sample prep, power module (preprocessor definitions set there now not naatos_config.h) and bootloader/jlink linker selections; set batch-build options",v3.4,<devops>
ac222da59af30d323b6c9df144bd7c97c87e95f7,3/10/2025 14:44,Simon Ghionea,,"fix issue with USB CDC command CFGSET parsing floating point value string, refactored key-value configuration table to use functions from naatos_config_file.c",v3.4,add USB cdc commands
bd0f0eb9b25fc472b698101c5afcaddbc0a8726c,3/10/2025 15:40,Simon Ghionea,,"upon run completion, verify that the run took the expected amount of time in order to exit with solid green/success, add c standard library mktime and difftime support for RTC handling",v3.4,add check for total run time taken within tolerance
2a97de710842f99e560d7a6c4ba6268c1fd6d70a,3/10/2025 21:32,Simon Ghionea,,add option to use RTC-queried time for cycle running state-machine (option: FSM_USE_RTC_FOR_CYCLE_TIME),v3.4,use RTC time for run state machine
4a2ff8115fe39d219434a7fe7dc8bc997fa364e9,3/11/2025 13:43,Simon Ghionea,,fix issue where tps55288 valve power supply was occasionally not being set to 6V settings; redid the TPS55288 handling,v3.4,"fix powermodule issue with valve power supply, we are now reinitializing the chip completely every sensor sample cycle"
9525b7619626000d77d5f70c53bdb6660e62d86a,3/11/2025 15:30,Simon Ghionea,,add per-cycle run-time checking and a cycle parameter,v3.4,catch at the cycle-level if the cycle took too long to complete
d2a92546a116d43c3c7f9ef901b2021017e13641,3/12/2025 14:47,Simon Ghionea,tag: V3.4,update defaults,v3.4,set default config
c909567595079684f32a77625e419a6dfe2ebadd,3/13/2025 20:56,Simon Ghionea,,change default for powermodule cycle2 to allow longer rtc vs tick time-error,v3.5,set default config
374f031a61f26dadc959e88126a9cc9a483c1ae3,3/13/2025 21:00,Simon Ghionea,,"added rtc calendar query retry mechanism and checking for known bad dates (day=00, month=00, year=2080) which became a problem for us when switching the cycle state machine to use RTC time",v3.5,handle occasional RTC bad date through retry mechanism
fededd94d223fb3a997989eb23e3d4bc9415a209,3/13/2025 21:08,Simon Ghionea,,add catch for high error between cputick and rtc cycle timer to abort at inner-cycle-level if time is beyond config.accept_run_time_error_s,v3.5,catch in the middle of a cycle if our runtime according to cputicks has a severe disagreement from the rtc time we are using to measure the cycle runtime
c65236d95be5833b3efd4a6d6760fa659b3270f1,3/13/2025 21:10,Simon Ghionea,,kick hardware watchdog just prior to resetting for DFU-entry,v3.5,improve reliability of DFU entry
cf9676cc7ce91dd2a879ed74d982323b33be893a,3/14/2025 7:26,Simon Ghionea,,add an additional TPS55288 retry mechanism for valve supply workaround in sensors.c,v3.5,add a retry mechanism in powermodule sensors data collection to deal with valve power supply workaround
af599fdccaeba70c29128127e2741a682f30ef10,3/14/2025 7:31,Simon Ghionea,,"fixed issue with battery overtemperature error, where it would not have been handled appropriately",v3.5,"fixed issue with battery overtemperature error, where it would not have been handled appropriately"
d500503564d621335d432fa2427fb2ce99be481c,3/14/2025 8:15,Simon Ghionea,,bump version to 3.5,v3.5,set default config
02cca2bbe32ad0e865123255ad13c6d1dc84618b,3/14/2025 10:21,Simon Ghionea,,"change power module defaults to modify timing error allowances and grace periods, only timeout during cycle2 if timing error occurred",v3.5,set default config
74c22ab54ec15a315d87e29c930018ecfd71f487,3/14/2025 11:00,Simon Ghionea,"HEAD -> GHL_nextver, tag: V3.5, ghlgit/GHL_nextver",change sample prep cycle defaults,v3.5,set default config
